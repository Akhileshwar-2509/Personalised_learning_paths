{% extends "base.html" %}

{% block title %}{{ course.name }}{% endblock %}

{% block content %}
    <h2>{{ course.name }}</h2>
    <p>{{ course.description }}</p>

    {% if is_enrolled %}
    <h3>Resources</h3>
    {% if resources %}
        {% for resource in resources %}
            <div class="card">
                <h5>Resource: {{ resource.link }}</h5>
                <a href="{{ resource.link }}" target="_blank" class="btn">Open Resource</a>
                {% if resource.completed %}
                    <span class="badge badge-success">Completed</span>
                {% else %}
                    <a href="{{ url_for('student.complete_resource', resource_id=resource.id) }}" class="btn btn-secondary">Mark as Completed</a>
                {% endif %}
            </div>
        {% endfor %}
    {% else %}
        <p>No resources available for this course.</p>
    {% endif %}

        <h3>Assignments</h3>
        {% if assignments %}
            {% for assignment in assignments %}
                <div class="card">
                    <h4>{{ assignment.title }}</h4>
                    <p>Due: {{ assignment.due_date.strftime('%Y-%m-%d %H:%M') }}</p>
                    <p>{{ assignment.description }}</p>
                    {% if assignment.link %}
                        <a href="{{ assignment.link }}" target="_blank" class="btn">View Assignment</a>
                    {% endif %}
                </div>
            {% endfor %}
        {% else %}
            <p>No assignments available for this course.</p>
        {% endif %}

        {% if course.assignment_link %}
            <h3>Additional Assignments</h3>
            <div class="card">
                <a href="{{ course.assignment_link }}" target="_blank" class="btn">View Additional Assignments</a>
            </div>
        {% endif %}
    {% else %}
        <p>You are not enrolled in this course. Would you like to join?</p>
        <a href="{{ url_for('student.join_course', course_id=course.id) }}" class="btn btn-primary">Join Course</a>
    {% endif %}
{% endblock %}